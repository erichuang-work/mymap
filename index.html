<!DOCTYPE html>
<html>
<head>
    <title>æˆ‘çš„é›²ç«¯åœ°åœ–</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch@latest/dist/geosearch.css" />
    <style> #map { width: 100%; height: 100vh; margin: 0; } </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-geosearch@latest/dist/bundle.min.js"></script>
    <script>
        // 1. åˆå§‹åŒ–åœ°åœ–
        const map = L.map('map').setView([25.03, 121.56], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // 2. åŠ å…¥æœå°‹åŠŸèƒ½ (å…è²» Nominatim)
        const searchControl = new GeoSearch.GeoSearchControl({
            provider: new GeoSearch.OpenStreetMapProvider(),
            style: 'bar',
            autoClose: true,
            keepResult: true
        });
        map.addControl(searchControl);

        // 3. é»æ“Šåœ°åœ–æ–°å¢åœ°é»ä¸¦å­˜å…¥ Google è©¦ç®—è¡¨
        const gasUrl = 'https://script.google.com/macros/s/AKfycbyvtQRocbF-obUe4Kpa6atpCag-VlKxyFmWQAjvkT_FDltGMQgbepfFo7VFRaNJy9rgCg/exec';
        map.on('click', function(e) {
            const name = prompt("è«‹è¼¸å…¥æ™¯é»åç¨±ï¼š");
            if (!name) return;

            const data = { name: name, lat: e.latlng.lat, lng: e.latlng.lng, desc: "ç¶²é æ–°å¢" };

          fetch(gasUrl, {
    method: 'POST',
    mode: 'no-cors', // ğŸ’¡ åŠ ä¸Šé€™è¡Œå¯ä»¥å¼·åˆ¶é¿é–‹ CORS æª¢æŸ¥
    cache: 'no-cache',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
})
.then(() => {
    // ğŸ’¡ å› ç‚ºç”¨äº† no-corsï¼Œç€è¦½å™¨å›å‚³æœƒæ˜¯ç©ºçš„ï¼Œæ‰€ä»¥ç›´æ¥åŸ·è¡ŒæˆåŠŸå¾Œçš„å‹•ä½œ
    alert("æ™¯é»å·²é€å‡ºï¼Œè«‹ç¨å¾Œæª¢æŸ¥è©¦ç®—è¡¨ï¼");
    L.marker([data.lat, data.lng]).addTo(map).bindPopup(data.name).openPopup();
});
                });
        });

        // 4. (é¸å¡«) å¾ç™¼ä½ˆçš„ CSV è¼‰å…¥èˆŠæœ‰çš„æ‰€æœ‰åœ°é»
        // fetch('ä½ çš„CSVç¶²å€').then(...è§£æèˆ‡ç•«å‡º Marker...);
    </script>
</body>

</html>


